	SUBROUTINE TYPINF(INF,LINES)

C	INTEGER I,N,LINE,LINES,INF(LINES*16)
	INTEGER I,N,LINE,LINES,INF(160)

	DO 20 LINE=1,LINES
	N=(LINE*16)-15
	IF (INF(N).EQ.'.    ') RETURN
	TYPE 10,(INF(I),I=N,N+15)
10	FORMAT(1X,16A5)
20	CONTINUE

	RETURN
	END
	SUBROUTINE GETINF(INF,LINES,RET)

C	INTEGER I,N,LINE,LINES,RET,INF(LINES*16)
	INTEGER I,N,LINE,LINES,RET,INF(160)

	RET=0
	DO 20 LINE=1,LINES
	N=(LINE*16)-15
	ACCEPT 10,(INF(I),I=N,N+15)
10	FORMAT(16A5)
	IF (INF(N).EQ.'.    ') RETURN
	RET=LINE
20	CONTINUE
	RETURN
	END
        SUBROUTINE WRTINF(INF,LINES)
C
C       SUBROUTINE FOR THE PURPOSE OF WRITING INFO FROM
C       THE PROBLEM DESCRIPTION OR STATUSES WITHOUT THE
C	PERIOD OR FOLLOWING LINES
C
C        INTEGER I,N,LINE,LINES,INF(LINES*16)
        INTEGER I,N,LINE,LINES,INF(160)

	DO 20 LINE=1,LINES
	N=(LINE*16)-15
	IF (INF(N).EQ.'.    ') RETURN
	WRITE(8,10)(INF(I),I=N,N+15)
10	FORMAT(16A5)
20	CONTINUE
        RETURN
	END

	SUBROUTINE FGMT( MONTH,DAY,YEAR, HOUR,MINUTE,SECOND )
	INTEGER MONTH,DAY,YEAR,HOUR,MINUTE,SECOND
	INTEGER DT(2),TM,TM1,TM2,H1,H2,MMM,MON(12),I
	DATA (MON(I),I=1,12)/
     +  "453035620100, "433134220100, "467036220100,
     +  "407416220100, "467037120100, "453535620100,
     +  "453535420100, "407534720100, "517136020100,
     +  "477076420100, "473376620100, "423134320100/
C     + 'Jan','Feb','Mar','Apr','May','Jun',
C     + 'Jul','Aug','Sep','Oct','Nov','Dec'/

	CALL TIME(TM1)
	CALL DATE(DT)
	CALL TIME(TM2)

10	FORMAT(I2,1X,I2)
20	FORMAT(I2,1X,A3,1X,I2)
	DECODE(2,10,TM1)H1
	DECODE(2,10,TM2)H2
	IF ( H2 .LT. H1 ) CALL DATE(DT)

	DECODE(5,10,TM2)HOUR,MINUTE
	DECODE(9,20,DT)DAY,MMM,YEAR

	DO 30 I=1,12
	IF ( MMM .EQ. MON(I) ) GOTO 40
30	CONTINUE
40	MONTH=I
	SECOND=0
	RETURN
	END

	SUBROUTINE WAITS(SEC)
	REAL SEC
	TYPE 1,SEC
1	FORMAT(1X,'Waiting...',F)
	CALL WAIT(SEC)
	RETURN
	END

        SUBROUTINE HISET(IN)
C
C       ROUTINE TO FORCE 5 CHARACTERS TO UPPER CASE
C
        INTEGER IN,W(5),A,Z,S,I
	DATA a/"605004020100/
	DATA z/"751004020100/
	DATA s/"577777777777/

10      FORMAT(5A1)
        DECODE(5,10,IN)W
100     DO 150 I=1,5
        IF ((W(I).ge.a) .AND. (W(I).le.z)) W(I)=W(I) .AND. s
150     CONTINUE
        ENCODE(5,10,IN)W
        RETURN
        END

        SUBROUTINE UPCASE(VALUE)
C
C       ROUTINE TO FORCE CHARACTERS TO UPPER CASE
C
        INTEGER VALUE(4),I

100     DO 150 I=1,4
	CALL HISET(VALUE(I))
150     CONTINUE
        RETURN

        END

	SUBROUTINE BSETUP
C
C	ROUTINE TO SETUP THE BASE ARRAY FROM BASES
C
	INTEGER SYSTYP
	INTEGER MTYPE
	DOUBLE PRECISION BASE,BASES,MTYPES,TXDEV,TXDIR
	COMMON /BASE/BASE(2,20)
	COMMON /BASES/BASES(20)
	COMMON /MTYPES/MTYPES(5)
	COMMON /TXDEV/TXDEV/TXDIR/TXDIR
	DATA TXDEV/'PAPER '/
	DATA TXDIR/'TNT   '/
	
C	1=T10, 2=ITS, 3=TNX, 4=T20, 5=TMX
	MTYPE=SYSTYP()
	TYPE 1,MTYPES(MTYPE)
1	FORMAT(1X,'RUNNING PAPER UNDER ',A10)
2	FORMAT(A6,14(1H ))

	DO 90 I=1,20
	ENCODE(20,2,BASE(1,I)) BASES(I)
10	FORMAT(A5,':',A6)
	IF (MTYPE .EQ. 1) ENCODE(12,10,BASE(1,I)) TXDEV,BASES(I)
40	FORMAT(A5,':',A6)
	IF (MTYPE .EQ. 4) ENCODE(12,40,BASE(1,I)) TXDEV,BASES(I)
50	FORMAT('(',A3,')',A6)
	IF (MTYPE .EQ. 5) ENCODE(11,50,BASE(1,I)) TXDIR,BASES(I)
90	CONTINUE

	RETURN
	END

	SUBROUTINE SETBAS(BAS,TYP,TNUM)
C
C	ROUTINE TO SETUP A DATA BASE NAME FROM BASES
C	TXDEV, TXDIR DEFINED IN BSETUP
C
	INTEGER SYSTYP
	INTEGER MTYPE,BAS,TYP,TNUM,TKT,TKTT
	DOUBLE PRECISION BASE,BASES,MTYPES,TXDEV,TXDIR
	COMMON /BASE/BASE(2,20)
	COMMON /BASES/BASES(20)
	COMMON /MTYPES/MTYPES(5)
	COMMON /TXDEV/TXDEV/TXDIR/TXDIR

C	1=T10, 2=ITS, 3=TNX, 4=T20, 5=TMX
	MTYPE=SYSTYP()

	TKT=TNUM/10000
	TKT=TKT*10
2	FORMAT('0',I2)
3	FORMAT(I3)
	ENCODE(3,3,TKTT)TKT
	IF (TKT .LT. 100) ENCODE(3,2,TKTT)TKT

9	FORMAT(A3,A2,14(1H ))
	ENCODE(20,9,BASE(1,BAS)) TYP,TKTT
10	FORMAT(A5,':',A2,A3)
	IF (MTYPE .EQ. 1) ENCODE(12,10,BASE(1,BAS)) TXDEV,TYP,TKTT
40	FORMAT(A5,':',A2,A3)
	IF (MTYPE .EQ. 4) ENCODE(12,40,BASE(1,BAS)) TXDEV,TYP,TKTT
50	FORMAT('(',A3,')',A2,A3)
	IF (MTYPE .EQ. 5) ENCODE(11,50,BASE(1,BAS)) TXDIR,TYP,TKTT

	RETURN
	END
