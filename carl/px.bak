	SUBROUTINE BSETUP
C
C	ROUTINE TO SETUP THE BASE ARRAY FROM BASES
C
	INTEGER MTYPE
	DOUBLE PRECISION BASE,BASES,MTYPES,TXDEV,TXDIR
	COMMON /BASE/BASE(2,20)
	COMMON /BASES/BASES(20)
	COMMON /MTYPES/MTYPES(5)
	COMMON /TXDEV/TXDEV/TXDIR/TXDIR
	DATA TXDEV/'PAPER '/
	DATA TXDIR/'TNT   '/
	
C	1=T10, 2=ITS, 3=TNX, 4=T20, 5=TMX
	MTYPE=MONTYP()
	TYPE 1,MTYPES(MTYPE)
1	FORMAT(1X,'RUNNING PAPER UNDER ',A10)
2	FORMAT(A6,14(1H ))

	DO 90 I=1,20
	ENCODE(20,2,BASE(1,I)) BASES(I)
10	FORMAT(A5,':',A6)
	IF (MTYPE .EQ. 1) ENCODE(12,10,BASE(1,I)) TXDEV,BASES(I)
40	FORMAT(A5,':',A6)
	IF (MTYPE .EQ. 4) ENCODE(12,40,BASE(1,I)) TXDEV,BASES(I)
50	FORMAT('(',A3,')',A6)
	IF (MTYPE .EQ. 5) ENCODE(11,50,BASE(1,I)) TXDIR,BASES(I)
90	CONTINUE

	RETURN
	END

	SUBROUTINE SETBAS(BAS,TYP,TNUM)
C
C	ROUTINE TO SETUP A DATA BASE NAME FROM BASES
C	TXDEV, TXDIR DEFINED IN BSETUP
C
	INTEGER MTYPE,BAS,TYP,TNUM,TKT,TKTT
	DOUBLE PRECISION BASE,BASES,MTYPES,TXDEV,TXDIR
	COMMON /BASE/BASE(2,20)
	COMMON /BASES/BASES(20)
	COMMON /MTYPES/MTYPES(5)
	COMMON /TXDEV/TXDEV/TXDIR/TXDIR

C	1=T10, 2=ITS, 3=TNX, 4=T20, 5=TMX
	MTYPE=MONTYP()

	TKT=TNUM/10000
	TKT=TKT*10
2	FORMAT('0',I2)
3	FORMAT(I3)
	ENCODE(3,3,TKTT)TKT
	IF (TKT .LT. 100) ENCODE(3,2,TKTT)TKT

9	FORMAT(A3,A2,14(1H ))
	ENCODE(20,9,BASE(1,BAS)) TYP,TKTT
10	FORMAT(A5,':',A2,A3)
	IF (MTYPE .EQ. 1) ENCODE(12,10,BASE(1,BAS)) TXDEV,TYP,TKTT
40	FORMAT(A5,':',A2,A3)
	IF (MTYPE .EQ. 4) ENCODE(12,40,BASE(1,BAS)) TXDEV,TYP,TKTT
50	FORMAT('(',A3,')',A2,A3)
	IF (MTYPE .EQ. 5) ENCODE(11,50,BASE(1,BAS)) TXDIR,TYP,TKTT

	RETURN
	END
